# backend/templates/components/experiments/experiment-table-row.html

{#
  Experiment Table Row Component
  backend/templates/components/experiments/experiment-table-row.html
#}

<tr class="hover:bg-gray-50" data-experiment-id="{{ experiment.id }}">
  <td class="px-6 py-4">
    <div>
      <div class="font-medium text-gray-900 cursor-pointer hover:text-brand-600 transition-colors"
           onclick="MAB.viewExperiment('{{ experiment.id }}')">
        {{ experiment.name }}
      </div>
      <div class="text-sm text-gray-500">{{ experiment.url | urlparse }}</div>
      {% if experiment.description %}
      <div class="text-xs text-gray-400 mt-1">{{ experiment.description | truncate(60) }}</div>
      {% endif %}
    </div>
  </td>
  
  <td class="px-6 py-4">
    {% include 'components/ui/badge.html' with {
      'type': experiment.status,
      'text': experiment.status | title,
      'size': 'sm'
    } %}
  </td>
  
  <td class="px-6 py-4 text-sm text-gray-900" data-live-metric="visitors-{{ experiment.id }}">
    {{ experiment.stats.total_users | default(0) | number_format }}
  </td>
  
  <td class="px-6 py-4 text-sm text-gray-900" data-live-metric="conversion-{{ experiment.id }}">
    {{ (experiment.stats.conversion_rate * 100) | round(1) if experiment.stats.conversion_rate else '0.0' }}%
  </td>
  
  <td class="px-6 py-4 text-sm text-gray-900" data-live-metric="confidence-{{ experiment.id }}">
    {% if experiment.status == 'active' %}
      {% set confidence = experiment.stats.confidence | default(0) %}
      <span class="{{ 'text-error-600' if confidence < 80 else 'text-warning-600' if confidence < 95 else 'text-success-600' }}">
        {{ confidence | round }}%
      </span>
    {% else %}
      <span class="text-gray-400">-</span>
    {% endif %}
  </td>
  
  <td class="px-6 py-4 text-sm text-gray-500">
    {{ experiment.created_at | timeago }}
  </td>
  
  <td class="px-6 py-4 text-right">
    <div class="flex items-center justify-end gap-2">
      <button onclick="MAB.viewExperiment('{{ experiment.id }}')" 
              class="btn btn-sm btn-secondary">
        View
      </button>
      
      {% if experiment.status == 'draft' %}
        <button data-action="start-experiment" data-target="{{ experiment.id }}" 
                class="btn btn-sm btn-primary">
          Start
        </button>
      {% elif experiment.status == 'active' %}
        <button data-action="pause-experiment" data-target="{{ experiment.id }}" 
                class="btn btn-sm btn-warning">
          Pause
        </button>
      {% elif experiment.status == 'paused' %}
        <button data-action="resume-experiment" data-target="{{ experiment.id }}" 
                class="btn btn-sm btn-success">
          Resume
        </button>
      {% endif %}
    </div>
  </td>
</tr>
